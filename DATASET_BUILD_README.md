# í•„í„°ë§ëœ YOLO ë°ì´í„°ì…‹ ë¹Œë” ì‚¬ìš©ë²•

## ê°œìš”

`build_filtered_dataset.py`ëŠ” íŒŒì´í”„ ê²€ì‚¬ í”„ë¡œì íŠ¸ì—ì„œ íŠ¹ì • í´ë˜ìŠ¤ë§Œ ì¶”ì¶œí•˜ì—¬ YOLO ì„¸ê·¸ë©˜í…Œì´ì…˜ í•™ìŠµ ë°ì´í„°ì…‹ì„ ìƒì„±í•˜ëŠ” ì „ìš© ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

## íŠ¹ì§•

- âœ… íŠ¹ì • í´ë˜ìŠ¤ë§Œ ì„ íƒì ìœ¼ë¡œ ì¶”ì¶œ (ì˜ˆ: slime, ì†Œì‹¤ì )
- âœ… í•œê¸€/ì˜ë¬¸ í´ë˜ìŠ¤ëª… ìë™ ë§¤í•‘
- âœ… Train/Val/Test ìë™ ë¶„í• 
- âœ… YOLO ì„¸ê·¸ë©˜í…Œì´ì…˜ í˜•ì‹ (í´ë¦¬ê³¤ ì¢Œí‘œ)
- âœ… ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤(.mp4) ìë™ íƒìƒ‰
- âœ… ë‹¤ì¤‘ ì‚¬ìš©ì ì–´ë…¸í…Œì´ì…˜ í†µí•©

## ì„¤ì¹˜ ë° ìš”êµ¬ì‚¬í•­

Python íŒ¨í‚¤ì§€:
```bash
source .venv/bin/activate  # ê°€ìƒí™˜ê²½ í™œì„±í™” í•„ìˆ˜
```

í•„ìš”í•œ íŒ¨í‚¤ì§€ (ì´ë¯¸ ì„¤ì¹˜ë¨):
- opencv-python (cv2)
- numpy

## ì‚¬ìš©ë²•

### ê¸°ë³¸ ì‚¬ìš©

```bash
source .venv/bin/activate

python3 build_filtered_dataset.py \
  --project-dir /home/intu/Nas2/k_water/pipe_inspector_data/jsKim/PEê´€ì¢…_ë“±_1761200630 \
  --classes slime ì†Œì‹¤ì  \
  --output-dir ./dataset_slime_vanishing
```

### ì „ì²´ ì˜µì…˜

```bash
python3 build_filtered_dataset.py \
  --project-dir <í”„ë¡œì íŠ¸_ê²½ë¡œ> \
  --classes <í´ë˜ìŠ¤1> <í´ë˜ìŠ¤2> ... \
  --output-dir <ì¶œë ¥_ë””ë ‰í† ë¦¬> \
  --split 0.7,0.15,0.15 \
  --videos-web-dir /home/intu/nas2_kwater/Videos_web
```

### ë§¤ê°œë³€ìˆ˜ ì„¤ëª…

| ë§¤ê°œë³€ìˆ˜ | í•„ìˆ˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|---------|------|------|--------|
| `--project-dir` | âœ… | í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ê²½ë¡œ | - |
| `--classes` | âœ… | ì¶”ì¶œí•  í´ë˜ìŠ¤ ëª©ë¡ (ê³µë°±ìœ¼ë¡œ êµ¬ë¶„) | - |
| `--output-dir` | âŒ | ì¶œë ¥ ë””ë ‰í† ë¦¬ ê²½ë¡œ | `filtered_dataset` |
| `--split` | âŒ | Train/Val/Test ë¹„ìœ¨ | `0.7,0.15,0.15` |
| `--videos-web-dir` | âŒ | ì›¹ í˜¸í™˜ ë¹„ë””ì˜¤ ë””ë ‰í† ë¦¬ | `/home/intu/nas2_kwater/Videos_web` |

## ì§€ì›ë˜ëŠ” í´ë˜ìŠ¤

### ìë™ ë§¤í•‘ë˜ëŠ” í´ë˜ìŠ¤

ìŠ¤í¬ë¦½íŠ¸ëŠ” í•œê¸€ê³¼ ì˜ë¬¸ í´ë˜ìŠ¤ëª…ì„ ìë™ìœ¼ë¡œ ë§¤í•‘í•©ë‹ˆë‹¤:

**slime í´ë˜ìŠ¤:**
- `slime`
- `slime(ë¬¼ë•Œ)`
- `ìŠ¬ë¼ì„(ë¬¼ë•Œ)`
- `ìŠ¬ë¼ì„`

**ì†Œì‹¤ì  í´ë˜ìŠ¤:**
- `ì†Œì‹¤ì `
- `vanishing_point`

### ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ì¶”ê°€

`build_filtered_dataset.py`ì˜ `class_aliases` ë”•ì…”ë„ˆë¦¬ë¥¼ ìˆ˜ì •í•˜ì—¬ ì¶”ê°€ í´ë˜ìŠ¤ë¥¼ ë§¤í•‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
class_aliases = {
    'slime': ['slime', 'slime(ë¬¼ë•Œ)', 'ìŠ¬ë¼ì„(ë¬¼ë•Œ)', 'ìŠ¬ë¼ì„'],
    'ì†Œì‹¤ì ': ['ì†Œì‹¤ì ', 'vanishing_point'],
    'ê· ì—´': ['crack', 'ê· ì—´'],  # ì¶”ê°€ ì˜ˆì‹œ
}
```

## ì¶œë ¥ êµ¬ì¡°

ìƒì„±ëœ ë°ì´í„°ì…‹ì€ YOLO í˜•ì‹ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

```
dataset_slime_vanishing/
â”œâ”€â”€ data.yaml          # YOLO ì„¤ì • íŒŒì¼
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ images/        # í•™ìŠµ ì´ë¯¸ì§€
â”‚   â””â”€â”€ labels/        # í•™ìŠµ ë¼ë²¨ (YOLO ì„¸ê·¸ë©˜í…Œì´ì…˜ í˜•ì‹)
â”œâ”€â”€ val/
â”‚   â”œâ”€â”€ images/        # ê²€ì¦ ì´ë¯¸ì§€
â”‚   â””â”€â”€ labels/        # ê²€ì¦ ë¼ë²¨
â””â”€â”€ test/
    â”œâ”€â”€ images/        # í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€
    â””â”€â”€ labels/        # í…ŒìŠ¤íŠ¸ ë¼ë²¨
```

### data.yaml ì˜ˆì‹œ

```yaml
# YOLO Segmentation Dataset
# Generated: 2025-11-04 20:47:32

path: /home/intu/projects/pipe-inspector-electron/dataset_slime_vanishing
train: train/images
val: val/images
test: test/images

nc: 2
names: ['slime', 'ì†Œì‹¤ì ']
```

### ë¼ë²¨ í˜•ì‹

YOLO ì„¸ê·¸ë©˜í…Œì´ì…˜ í˜•ì‹ (.txt íŒŒì¼):
```
class_id x1 y1 x2 y2 x3 y3 ... xn yn
```

ì¢Œí‘œëŠ” ì •ê·œí™”ë¨ (0.0 ~ 1.0 ë²”ìœ„)

## ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ

### 1. slimeê³¼ ì†Œì‹¤ì ë§Œ ì¶”ì¶œ

```bash
source .venv/bin/activate

python3 build_filtered_dataset.py \
  --project-dir /home/intu/Nas2/k_water/pipe_inspector_data/jsKim/PEê´€ì¢…_ë“±_1761200630 \
  --classes slime ì†Œì‹¤ì  \
  --output-dir ./dataset_slime_vanishing \
  --split 0.7,0.15,0.15
```

**ì˜ˆìƒ ì¶œë ¥:**
```
================================================================================
ğŸ¯ YOLO í•„í„°ë§ ë°ì´í„°ì…‹ ë¹Œë”
================================================================================
í”„ë¡œì íŠ¸: /home/intu/Nas2/k_water/pipe_inspector_data/jsKim/PEê´€ì¢…_ë“±_1761200630
íƒ€ê²Ÿ í´ë˜ìŠ¤: slime, ì†Œì‹¤ì 
ì¶œë ¥ ë””ë ‰í† ë¦¬: ./dataset_slime_vanishing
Split ë¹„ìœ¨: 0.7,0.15,0.15

================================================================================
ğŸ” ì–´ë…¸í…Œì´ì…˜ ìˆ˜ì§‘ ì¤‘...
================================================================================
íƒ€ê²Ÿ í´ë˜ìŠ¤: slime, ì†Œì‹¤ì 

âœ… ìˆ˜ì§‘ ì™„ë£Œ:
   - ì´ í”„ë ˆì„: 1,118ê°œ
   - slime: 1,821ê°œ
   - ì†Œì‹¤ì : 200ê°œ

================================================================================
ğŸ“Š ë°ì´í„°ì…‹ ë¶„í•  ì¤‘...
================================================================================
   train: 783ê°œ
   val: 167ê°œ
   test: 168ê°œ

================================================================================
ğŸ—ï¸  ë°ì´í„°ì…‹ ë¹Œë“œ ì¤‘...
================================================================================

ğŸ“¦ TRAIN ì„¸íŠ¸ ìƒì„± ì¤‘... (783ê°œ í”„ë ˆì„)
   ì§„í–‰: 50/783 í”„ë ˆì„
   ...
   âœ… train: 783ê°œ ì €ì¥ë¨

ğŸ“¦ VAL ì„¸íŠ¸ ìƒì„± ì¤‘... (167ê°œ í”„ë ˆì„)
   âœ… val: 167ê°œ ì €ì¥ë¨

ğŸ“¦ TEST ì„¸íŠ¸ ìƒì„± ì¤‘... (168ê°œ í”„ë ˆì„)
   âœ… test: 168ê°œ ì €ì¥ë¨

================================================================================
âœ… ë°ì´í„°ì…‹ ë¹Œë“œ ì™„ë£Œ!
================================================================================
ì´ ì €ì¥ëœ ì´ë¯¸ì§€: 1,118ê°œ
ì¶œë ¥ ë””ë ‰í† ë¦¬: /home/intu/projects/pipe-inspector-electron/dataset_slime_vanishing
ì„¤ì • íŒŒì¼: /home/intu/projects/pipe-inspector-electron/dataset_slime_vanishing/data.yaml
================================================================================

âœ¨ ì„±ê³µì ìœ¼ë¡œ 1,118ê°œì˜ ì´ë¯¸ì§€ë¡œ ë°ì´í„°ì…‹ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤!
ğŸ“ /home/intu/projects/pipe-inspector-electron/dataset_slime_vanishing/data.yaml ì„ í™•ì¸í•˜ì„¸ìš”.
```

### 2. ë‹¤ë¥¸ ë¹„ìœ¨ë¡œ ë¶„í• 

```bash
source .venv/bin/activate

python3 build_filtered_dataset.py \
  --project-dir /home/intu/Nas2/k_water/pipe_inspector_data/jsKim/PEê´€ì¢…_ë“±_1761200630 \
  --classes slime ì†Œì‹¤ì  \
  --output-dir ./dataset_custom_split \
  --split 0.8,0.1,0.1
```

## YOLO í•™ìŠµ ì‚¬ìš©ë²•

ìƒì„±ëœ ë°ì´í„°ì…‹ìœ¼ë¡œ YOLO ëª¨ë¸ í•™ìŠµ:

```python
from ultralytics import YOLO

# ëª¨ë¸ ë¡œë“œ
model = YOLO('yolov8n-seg.pt')  # YOLOv8 Nano segmentation

# í•™ìŠµ
results = model.train(
    data='dataset_slime_vanishing/data.yaml',
    epochs=100,
    imgsz=640,
    batch=16,
    name='pipe_slime_vanishing',
    project='runs/segment'
)

# ê²€ì¦
results = model.val()

# ì˜ˆì¸¡
results = model.predict(source='test_image.jpg')
```

## ë¬¸ì œ í•´ê²°

### ë¹„ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ

**ì˜¤ë¥˜:**
```
âš ï¸  ë¹„ë””ì˜¤ íŒŒì¼ ì—†ìŒ: /home/intu/nas2_kwater/Videos_web/ê´€ë‚´ì‹œê²½ì˜ìƒ/.../xxx.mp4
```

**í•´ê²°:**
1. ì›ë³¸ .avi íŒŒì¼ì´ .mp4ë¡œ ë³€í™˜ë˜ì—ˆëŠ”ì§€ í™•ì¸
2. `--videos-web-dir` ê²½ë¡œê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸

### ì–´ë…¸í…Œì´ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ

**ì˜¤ë¥˜:**
```
âŒ íƒ€ê²Ÿ í´ë˜ìŠ¤ì˜ ì–´ë…¸í…Œì´ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
```

**í•´ê²°:**
1. í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ê²½ë¡œê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
2. ì§€ì •í•œ í´ë˜ìŠ¤ëª…ì´ ì‹¤ì œ ì–´ë…¸í…Œì´ì…˜ì˜ labelê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
3. `annotations/` í´ë”ì— JSON íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸

### í”„ë ˆì„ ì¶”ì¶œ ì‹¤íŒ¨

**ê²½ê³ :**
```
âš ï¸  í”„ë ˆì„ ì¶”ì¶œ ì‹¤íŒ¨: /path/to/video.mp4 #12345
```

**ì›ì¸:**
- ë¹„ë””ì˜¤ ì†ìƒ ë˜ëŠ” h264 ë””ì½”ë”© ì˜¤ë¥˜
- í”„ë ˆì„ ë²ˆí˜¸ê°€ ë¹„ë””ì˜¤ ë²”ìœ„ ì´ˆê³¼

**í•´ê²°:**
- í•´ë‹¹ í”„ë ˆì„ì€ ìë™ìœ¼ë¡œ ìŠ¤í‚µë¨
- ì‹¬ê°í•œ ê²½ìš° ë¹„ë””ì˜¤ ì¬ë³€í™˜ í•„ìš”

## ì„±ëŠ¥ íŒ

1. **SSD/NVMe ì‚¬ìš©**: ë¹„ë””ì˜¤ ì½ê¸° ì†ë„ í–¥ìƒ
2. **ë³‘ë ¬ ì²˜ë¦¬**: í˜„ì¬ëŠ” ìˆœì°¨ ì²˜ë¦¬, í•„ìš”ì‹œ ë©€í‹°í”„ë¡œì„¸ì‹± ì¶”ê°€ ê°€ëŠ¥
3. **ìƒ˜í”Œë§**: í”„ë ˆì„ ìˆ˜ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì¼ë¶€ë§Œ ì„ íƒí•˜ë„ë¡ ìˆ˜ì •

## ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜

```
/home/intu/projects/pipe-inspector-electron/build_filtered_dataset.py
```

## ë¼ì´ì„ ìŠ¤

íŒŒì´í”„ ê²€ì‚¬ ì–´ë…¸í…Œì´ì…˜ ì‹œìŠ¤í…œì˜ ì¼ë¶€ì…ë‹ˆë‹¤.
